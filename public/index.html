<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Defines meta data for characters and viewport -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">

  <!-- Website Title -->
  <title>SpotDPothole</title>

  <!-- Website Description Metadata -->
  <meta content="A web application designed for the logging and viewing of potholes located around Trinidad and Tobago." name="description">
  <meta content="SpotDPothole, Tracker, Report, Leaderboard, Dashboard, Constituency, Trinidad and Tobago, Councillor, Pothole, Roads, Routing, Roadways" name="keywords">
  
  <!-- Sets the PWA theme color, manifest and iOS icon -->
  <meta name="theme-color" content="#000000"/>
  <link crossorigin="anonymous" rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="images/icons-192.png">

  <!-- Favicons -->
  <link href="images/favicon-16x16.png" rel="icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com/css?family=Open+Sans:300|Poppins:300,400,500" rel="stylesheet">

  <!-- Bootstrap CSS Files -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

  <!-- Template Main CSS File -->
  <link href="css/style.css" rel="stylesheet">

  <!-- Imports Leaflet Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet-pip@1.1.0/leaflet-pip.js"></script>
  <link rel="stylesheet" href="css/leaflet.min.css" />

  <!-- Imports Routing Libraries -->
  <script src="js/leaflet-routing-machine.js" defer></script>
  <script src="js/leaflet.geometryutil.js" defer></script>

  <!-- Imports Offline Map Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/0.3.1/js/sql.js" integrity="sha512-muXXdXO1t5rrZE2+CV2wY+1Ojap/QIxTZRqhyN7zBOv9/Dmuhc6A68k+mMBX7EElEPB5N0oR3zWP3TsoBcgKiQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="js/Leaflet.TileLayer.MBTiles.js"></script>

  <!-- =======================================================
  * Template Name: iPortfolio - v3.7.0
  * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->


  <script>
    //Used to display a toast with a message.
    function displayToast(type, message, customDuration=2.5) {
        //Creates the id for the notification using the date.
      var id = Date.now() + ' - ' + "notification_" + (Math.random() + 1).toString(36).substring(5);
        //Creates a new div and sets the meassge content.
      var div = document.createElement('div');
      div.innerHTML = `<p class="m-0 p-0 text-white">${message}</p>`;

        //Sets the attributes of the toast div.
      div.setAttribute('id', id)
      div.setAttribute('class', '');

        
      
        //Sets the color of the div based on the message type.
      if(type=='success'){
        div.setAttribute('class', "message success show");    
      } else if (type=='sync'){
            div.setAttribute('class', "message sync show");  
        } else if (type=='install'){
            div.setAttribute('class', "message refresh install");  
        } else {
        div.setAttribute('class', "message failed show");
      }

        //Adds the toast to the DOM.
        document.getElementById('mainTabContent').appendChild(div);

      // After 4 seconds, remove the show class from DIV
      setTimeout(() => { 
        let element = document.getElementById(id);
        element.className = element.className.replace("show", "hide"); 
      }, customDuration*1000 + 500);
    }


    //Determines if the browser supports the service worker.
    if ('serviceWorker' in navigator) {
        //If supported, register the service worker once the page has loaded.
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('sw.js').then(reg => {
              reg.onupdatefound = () => {
                const installingWorker = reg.installing;
                installingWorker.onstatechange = () => {
                  if (installingWorker.state === 'installed' || installingWorker.state === 'activated') {
                    displayToast("install", '<a class="text-decoration-underline text-white" href="index.html">Application Initialized. Tap here to refresh or wait 10 seconds.</a>', 9)
                    setTimeout(()=>{
                        window.location.reload();
                    }, 10000)
                  }
                };
              };
            });

            navigator.serviceWorker.getRegistration().then(function(reg) {
              // If there is a service worker but no controller, soft reset the page.
              try {
                if (reg.active && !navigator.serviceWorker.controller) {
                  //Refreshes the page to get consistent data.
                  console.log("Hard refresh detected; reloading service worker listeners.")
                  window.location.reload();
                }
              } catch(e){
                //Otherwise, there is no active registration and the service worker listeners must be initialized. Print the message.
                console.log("First use of application; service worker listeners must be initialized.")
              }
            });

            //When the service worker is ready, print a ready message.
            navigator.serviceWorker.ready.then(function(registration) {
                console.log('Service Worker Ready!')
            }).catch(function() {
                console.log('Service worker registration failed!')
            });
        }); 

        
      } else {
        console.log("Service workers not supported!")
      }
    </script>
</head>

<body>
  <!-- ======= Mobile nav toggle button ======= -->
  <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
  
  <!-- ======= Header ======= -->
  <header id="header">
    <div class="d-flex flex-column">

      <!-- ======= Displays the user's login state ======= -->
      <div class="profile">
        <a href="index.html">
          <img style="height:120px; width:120px;" alt="Application image logo icon." src="images/icons-512.png">
        </a>
        <div id="userNameArea">
          <h1 class="text-light">Guest</h1>
        </div>
      </div>

      <!-- ======= Navigational Options ======= -->
      <nav id="navbar" class="nav-menu navbar mt-3">
        <ul class="list-group list-group-flush">
          <li><a href="#map" onclick="displayPotholes()" data-bs-toggle="pill" data-bs-target="#mainTab-map"><i class="bi bi-house-fill"></i> <span>Home</span></a></li>
          <li><a href="#report" onclick="loadReportPage(event)" data-bs-toggle="pill" data-bs-target="#mainTab-report"><i class="bi bi-megaphone-fill"></i> <span>Make Report</span></a></li> 
          <!-- ====== Loads further options for logged-in users in this area ====== -->            
            <ul id="profileArea"></ul>
          <li><a href="#dashboard" onclick="loadDashboard()" data-bs-toggle="pill" data-bs-target="#mainTab-dashboard"><i class="bi bi-clipboard"></i> <span>Dashboard</span></a></li>
          <li><a href="#leaderboard" onclick="loadLeaderboardData()" data-bs-toggle="pill" data-bs-target="#mainTab-leaderboard"><i class="bi bi-bar-chart-fill"></i> <span>Leaderboard</span></a></li>
          <li><a href="#about" data-bs-toggle="pill" data-bs-target="#mainTab-about"><i class='bi bi-patch-question'></i> <span>About</span></a></li>
          <!-- ======= Loads options for Login/Logout based on the user context ======= -->
          <ul id="userContextGroup" class="list-group list-group-flush">
            <li><a href="#loginBtn" data-bs-toggle="modal" data-bs-target="#loginModal"><i class="bi bi-person-check-fill"></i> <span>Login / Register</span></a></li>
          </ul>
        </ul>
      </nav>
    </div>
  </header>

  <!-- ======= Main Content Section ======= -->
  <!-- Contains the tabs that have the main functions of the app, which are loaded based on the buttons in the menu -->
  <main id="main">
    <div class="d-flex flex-column justify-content-center align-items-center" style="padding:0px">
        <div class="container-fluid" style="padding-left: 0px; padding-right: 0px">
          <div class="tab-content" id="mainTabContent">
            <!-- Displays the home/map content for when the home button is clicked -->
              <div class="tab-pane active fade show" id="mainTab-map" role="tabpanel">
                <!-- Map is rendered here -->
                <div id="mapContent" class="p-0 mx-0"><div id="map" style="width: 100%; height:100vh"></div></div>

                <!-- ======= Map download button ======= -->
                <div id="mapDownloadButtonArea">
                  <i data-bs-toggle="tooltip" data-bs-placement="left" title="Download Offline Map" class="bi bi-download d-none" id="mapDownloadButton"></i>
                </div>

                <!-- ======= Mobile report button ======= -->
                <div id="driverReportButtonArea">
                  <!-- <button data-bs-toggle="modal" data-bs-target="#driverReportModal"><i class="bi bi-plus d-xl-none" id="driverReportButton"></i></button> -->
                </div>
                
                
              </div>

              <!-- ======= Report Section ======= -->

              <!-- Displays the reporting content for when the report button is clicked -->
              <div class="mt-3 tab-pane fade" id="mainTab-report" role="tabpanel" style="height:100%">
                <!-- Reporting actions; driver report button and standard report button -->
                <div id="reportContent" style="min-height: 75vh">
                </div>
            </div>

              <!-- ======= Dashboard Section ======= -->
              
              <!-- Displays the dashboard map when the dashboard button is clicked for a logged-in user-->
              <div class="tab-pane fade" id="mainTab-dashboard" role="tabpanel">
                <!-- Leaderboard content is displayed here -->
                <div id="dashboardContent" class="p-0 mx-0" role="tabpanel">
                  <div id="dashboardMessage"></div>
                  <!-- Dashboard Map is rendered here -->
                  <div id="dashboardMap" style="width:100%; height:1000px"></div>
                </div> 
              </div>
                 

           <!-- ======= Leaderboard Section ======= -->

            <!-- Displays the leaderboard content for when the leaderboard button is clicked -->
            <div class="tab-pane fade" id="mainTab-leaderboard" role="tabpanel">
              <div id="leaderboard" class="facts">

                <div class="section-title p-5">
                  <h2>Leaderboard</h2>
                </div>

              <!-- Leaderboard content is displayed here -->
              <div class="p-3" id="mainTab-leaderboard" role="tabpanel">
                  <!-- Displays the different leaderboard options -->
                  <ul class="nav nav-pills nav-justified mb-3 w-100" id="pills-tab-leaderboards" role="tablist" style="background: #040b14">
                      <!-- Displays the constituency pothole leaderboard button -->
                      <li class="nav-item" role="presentation">
                          <button class="btn btn-dark nav-link active" id="pills-constLeaderboard-tab" onclick="loadLeaderboardData()" data-bs-toggle="pill" data-bs-target="#pills-constLeaderboard" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Constituency Leaderboard</button>
                      </li>
                      <!-- Displays the most reported pothole leaderboard button -->
                      <li class="nav-item" role="presentation">
                          <button class="btn btn-dark nav-link" id="pills-reportLeaderboard-tab" onclick="loadReportLeaderboardData()" data-bs-toggle="pill" data-bs-target="#pills-reportLeaderboard" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Report Leaderboard</button>
                      </li>
                  </ul>

                  <!-- Displays the actual leaderboard depending on which leaderboard style is clicked -->
                  <div class="tab-content" id="pills-tabContent">
                      <!-- Contains the constituency pothole leaderboard content -->
                      <div class="tab-pane fade show active" id="pills-constLeaderboard" role="tabpanel" aria-labelledby="pills-home-tab">
                        <div class="text-center">
                          <h5><b>Ranking Constituencies by the Number of Potholes</b></h5>
                        </div>
                          <div id="leaderboardContent-c" class="w-100 p-3 row">
                              <div class="card p-3 leaderboard col-sm-12 col-xxl-12" style="overflow: auto;">
                                  <!-- Constituency Leaderboard data is dynamically loaded via AJAX -->
                                  <table id="constLeaderboard" class="table table-hover table-responsive"></table>
                              </div>
                          </div>
                      </div>

                      <!-- Contains the most reported pothole leaderboard content -->
                      <div class="tab-pane fade" id="pills-reportLeaderboard" role="tabpanel" aria-labelledby="pills-profile-tab">
                        <div class="text-center">
                          <h5><b>Ranking Potholes Nationwide by the Number of Reports</b></h5>
                        </div>
                          <div id="leaderboardContent-r" class="w-100 p-3 row">
                              <div class="card p-3 leaderboard col-sm-12 col-xxl-12" style="overflow: auto;">
                                  <!-- Most reported pothole data is dynamically loaded via AJAX -->
                                  <table id="reportLeaderboard" class="table table-hover table-responsive"></table>
                              </div>
                          </div>
                      </div>
                    </div>
                </div>  
              </div>
            </div>

            
            <!-- ======= About Section ======= -->
            <div class="tab-pane fade" id="mainTab-about" role="tabpanel">
              <div id="about">
                <div class="section-title p-5">
                  <h2>About</h2>
                </div>

                <!-- About content displayed here, displaying details about the app and its purpose-->
                <div class="ms-5 me-5" id="aboutContent">
                  <p>SpotDPothole is a pothole mapping web app that was initially developed by the NULLIFY team, consisting of Justin Baldeosingh,
                    Tevon Thatcher, Brandon Bharath, Jeremiah Strong, and Jordan Douglas. After the conclusion of the initial application, the project was
                    shifted to being developed by the NAV development team, consisting of Justin Baldeosingh, Brandon Bharath and Tevon Thatcher.
                    The purpose behind the app was to create a platform for citizens of Trinidad and Tobago to share their knowledge and frustration about the current state of the
                    nation's roadways. It is our hope that people will use this web app to promote awareness about the condition of the roads to prompt district representatives to take action.
                  </p>
                  <p class="mt-4">
                    Users that register with the application are allowed to report potholes from anywhere in the country. Anonymous users can freely browse a map of Trinidad 
                    and Tobago showing the reported potholes that plague the roads of both islands. Leaderboards are available that show which potholes have been reported the most,
                    and which areas of the country have the most potholes. Additionally, the routing feature allows users to choose a start and destination, and the application will 
                    show the user the path containing the least potholes. 
                  </p>
                </div>
                <footer id="footer">
                  <div class="pt-3 pb-3">
                    <div class="copyright text-center justify-content-center">
                      &copy; Copyright <strong><span>iPortfolio</span></strong>
                    </div>
                    <div class="credits text-center justify-content-center">
                      <!-- All the links in the footer should remain intact. -->
                      <!-- You can delete the links only if you purchased the pro version. -->
                      <!-- Licensing information: https://bootstrapmade.com/license/ -->
                      <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/ -->
                      Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
                    </div>
                  </div>
                </footer>
              </div> 
            </div>
            

          </div>

        </div>

      </section>
      <!-- End Main Content -->

    <!-- Modal used for reporting in standard mode -->
    <div class="modal fade" id="standardReportModal" tabindex="-1">
      <div class="modal-dialog">
          <div class="modal-content">
              <!-- Modal header; with modal title and close button -->
              <div class="modal-header">
                  <h5 class="modal-title fw-bold" id="exampleModalLabel">Standard Report</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <!-- Modal body; contains report form for filing a standard report-->
              <div class="modal-body">
                  <div id="standardReport" class="px-3 d-flex flex-column flex-no-wrap">
                      <!-- Description Text Area-->
                      <div class="d-flex flex-column " id="description">
                          <label class="fw-bold mb-3">Pothole Description</label>
                          <textarea class="form-control" rows="3" id="descriptionText" placeholder="Enter description of pothole. (min 5 characters)" required></textarea>
                      </div>

                      <!-- Coordinates Preview Area -->
                      <div class="d-flex flex-column mt-3" id="coordinates">
                          <label class="fw-bold mb-3">Pothole Coordinates</label>
                          <input type="text" class="form-control" id="coordinatesText" placeholder="lat, long" disabled>
                      </div>
                      
                      <!-- Image Preview Area -->
                      <div id ="img-container" class="d-flex justify-content-around">
                          <img id="pothole-img" class="w-100" src="" hidden/>
                      </div>
                      
                      <!-- Image Upload Area --> <!-- Refactor again -->
                      <div class="input-group justify-content-center mt-5 mb-5">
                          <button onclick="" class="btn btn-outline-transparent" > 
                              <label class="input-group-text " for="photo"><i class="bi bi-images"></i> <div class="ms-2">Select Image </div></label>
                          </button>
                          <button onclick="removeImage()" class="btn btn-danger rounded">x</button>
                          <div id="photoContainer">
                              <input id="photo" class="form-control-file" type="file" accept="image/*" onchange="showImage()" hidden> 
                          </div>
                      </div>
                      <div class="text-center" id="uploadProgress"></div>
                  </div>
              </div>

              <!-- Displays the submit button for the standard report -->
              <div class="modal-footer">
                  <button class="btn w-100" data-bs-target="#standardReportModal" data-bs-dismiss="modal" id="submit-passenger-report">Submit</button>
              </div>
          </div>
      </div>
    </div>


    <!-- Modal used for reporting in driver mode -->
    <div class="modal fade" id="driverReportModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal header; with modal title and close button -->
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="exampleModalLabel">Driver Report</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Modal body; contains buttons for reporting as a driver -->
                <div class="modal-body">
                    <div id="driverSubmitReport" class="p-3 accordion accordion-flush">
                        <!-- Displays the submit button as an accordion for confirmation -->
                        <div class="accordion-item">
                            <!-- Submit button for driver mode -->
                            <button class="btn btn-primary p-5 w-100" onclick='updateLocalCoords()' id="submit-driver-prereport" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                                Submit Pothole Report
                            </button>

                            <!-- Confirmation and Cancel options for deciding whether to submit the report -->
                            <div id="flush-collapseOne" class="mx-1 accordion-collapse collapse row justify-content-around" aria-labelledby="flush-headingOne" data-bs-parent="#driverSubmitReport">
                                <button class="btn btn-primary py-5 mt-3"  id="submit-driver-report" type="button" data-bs-dismiss="modal" data-bs-target="#driverReportModal" aria-expanded="false" aria-controls="flush-collapseOne">
                                    Confirm Submission
                                </button>
                                <button class="btn btn-danger py-5 mt-3"  type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                                    Cancel
                                </button>
                            </div>
                        </div>                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Management Modal -->
    <div class="modal fade" id="profileManagementModal" tabindex="-1">
      <div class="modal-dialog">
          <div id="profileManagementSection" class="modal-content">
              <!-- Enables menu options for login/registration, and a close button. -->
              <div class="modal-header">
                  <!-- Enables the user to select between login and registration at the top of the form. -->
                  <h5 class="modal-title" id="profileManagementModal">Profile</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <!-- Holds the registration and login tab content forms -->
              <div class="modal-body">
                <div class="accordion" id="profileAccordion">
                  <!-- Accordion item for updating user's the password -->
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="updatePassword">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUpdatePasswordForm" aria-expanded="false" aria-controls="collapseUpdatePasswordForm">
                        Update Password
                      </button>
                    </h2>
                    <div id="collapseUpdatePasswordForm" class="accordion-collapse collapse" aria-labelledby="updatePassword" data-bs-parent="#profileAccordion">
                      <div class="accordion-body">
                          <div class=" text-white mb-2">
                            <!-- Form used to update the password -->
                            <form class="form-group mb-1" onsubmit="changePassword(event)">
                                <!-- Enter old password -->
                                <label for="updatePassword-original">Old Password</label>
                                <input type="password" id="updatePassword-original" class="form-control mt-2" name="oldPassword" required>
                                <br>
                                <!-- Enter new password -->
                                <label for="updatePassword-password">Password</label>
                                <input type="password" id="updatePassword-password" class="form-control mt-2" name="password" required>
                                <br>
                                <!-- Re-enter new password -->
                                <label for="updatePassword-confirmPassword">Confirm Password</label>
                                <input type="password" id="updatePassword-confirmPassword" class="form-control mt-2" name="confirmPassword" required>
                                <br>
                                <!-- Form submit button -->
                                <div class="d-flex justify-content-center">
                                  <button type="submit" class="btn btn-primary" id="updatePasswordButton">Update Password</button>
                                </div>
                                <div class="mt-3" id="updatePasswordMessage"></div>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>

                  <!-- Accordion item for updating the user's profile information -->
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="updateProfileName">
                      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseUpdateProfileName" aria-expanded="false" aria-controls="collapseUpdateProfileName">
                        Update Profile
                      </button>
                    </h2>
                    <div id="collapseUpdateProfileName" class="accordion-collapse collapse" aria-labelledby="updateProfileName" data-bs-parent="#profileAccordion">
                      <div class="accordion-body">
                        <div class=" text-white mb-2">
                          <!-- Form for updating profile information -->
                            <form class="form-group mb-1" onsubmit="updateProfile(event)">
                                <!-- Update first name -->
                                <label for="updateProfile-firstName">First Name</label>
                                <input type="text" id="updateProfile-firstName" class="form-control mt-2" name="firstName" required>
                                <br>
                                <!-- Update last name -->
                                <label for="updateProfile-lastName">Last Name</label>
                                <input type="text" id="updateProfile-lastName" class="form-control mt-2" name="lastName" required>
                                <br>
                                <!-- Form submit button -->
                                <div class="d-flex justify-content-center">
                                  <button type="submit" class="btn btn-primary" id="updateProfileButton">Update Profile</button>
                                </div>
                                <div class="mt-3" id="updateProfileMessage"></div>
                            </form>
                        </div>
                      </div> 
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">

              </div>
          </div>
      </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
      <div class="modal-dialog">
          <div class="modal-content">
              <!-- Enables menu options for login/registration, and a close button. -->
              <div class="modal-header">
                  <!-- Enables the user to select between login and registration at the top of the form. -->
                  <nav class="col col-11">
                      <div class="nav nav-pills nav-fill" id="nav-tab" role="tablist">
                          <button class="nav-link active" id="nav-login-tab" data-bs-toggle="tab" data-bs-target="#nav-login" type="button" role="tab" >Login</button>
                          <button class="nav-link" id="nav-register-tab" data-bs-toggle="tab" data-bs-target="#nav-register" type="button" role="tab" >Register</button>
                          <button class="nav-link" id="nav-account-tab" data-bs-toggle="tab" data-bs-target="#nav-account" type="button" role="tab">Account</button>
                        </div>
                  </nav>
                  <button type="button" class="btn-close btn-close-white col-1" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <!-- Holds the registration, login  and account tab content forms -->
              <div class="modal-body">
                  <div class="tab-content" id="nav-tabContent">
                      <!-- Login tab of the modal -->
                      <div class="tab-pane fade show active" id="nav-login" role="tabpanel">
                          <div class="row align-items-start">
                              <!-- Displays application logo -->
                              <div class="col col-12 mb-5 d-flex justify-content-center">
                                  <img id="logo" src="images\icons-512.png" style="max-height: 200px" class="rounded float-start img-fluid">
                              </div>
                              
                              <!-- Displays login form -->
                              <div class="col col-12 px-5">
                                  <form id="loginForm" onsubmit="login(event)">
                                      <div id="welcome" class="d-flex justify-content-center">
                                          <h4 class="text-center">Welcome to the Pothole Spotter</h4>
                                      </div>
                                      <!-- Enter email address -->
                                      <div class="mb-3 pt-3">
                                          <label for="InputEmail" class="form-label fw-bold">Email Address</label>
                                          <input type="email" class="form-control" id="InputEmail" placeholder="Enter your email" required>
                                      </div>
                                      <!-- Enter password -->
                                      <div class="mb-3 pt-2" >
                                          <label for="InputPassword" class="form-label fw-bold">Password</label>
                                          <input type="password" class="form-control" id="InputPassword" placeholder="Enter your password" required>
                                      </div>

                                      <!-- Login Outcome Message -->
                                      <div class="d-flex justify-content-center" id="userLoginMessage"></div>

                                      <!-- Login button -->
                                      <div class="d-flex justify-content-center pt-3">
                                          <button id="loginButton" class="btn btn-primary btn-lg px-3">Login</button>
                                      </div>
                                  </form>

                                  <!-- Send Password Reset button -->
                                  <p class="mt-4 text-center">
                                    <a class="ms-auto" data-bs-toggle="collapse" href="#sendResetPassword" role="button" aria-expanded="false" aria-controls="collapseExample">
                                        Forgot your password?
                                    </a>
                                </p>
                                <!-- Collapse element containing the send password reset form -->
                                <div class="collapse" id="sendResetPassword">
                                  <div class="card card-body bg-light text-dark mb-2" id="sendResetCard">
                                      <form class="form-group mb-1" onsubmit="sendResetPassword(event)">
                                          <label for="resetPassword-email"><b>Email</b></label>
                                          <input type="email" id="resetPassword-email" class="form-control mt-2" name="email" required placeholder="Enter your email">
                                          <br>
                                          <button type="submit" class="btn btn-dark" id="sendResetButton">Send Reset Token</button>
                                          <div class="mt-3" id="sendResetPasswordMessage"></div>
                                      </form>
                                  </div>
                                </div>
                              </div>
                          </div>
                      </div>

                      <!-- Registration tab of the modal -->
                      <div class="tab-pane fade" id="nav-register" role="tabpanel">
                          <!-- Displays registration form -->
                          <form class="pt-1" onsubmit="register(event)">
                              <div class="row container">
                                  <!-- First Name Input -->
                                  <div class="col col-12 mb-3">
                                      <label for="InputFirstName" class="form-label fw-bold">First Name</label>
                                      <input type="name" class="form-control" id="regInputFirstName" placeholder="Enter your First Name" required>
                                  </div>

                                  <!-- Last Name Input -->
                                  <div class="col col-12 mb-3">
                                      <label for="InputLastName" class="form-label fw-bold">Last Name</label>
                                      <input type="name" class="form-control" id="regInputLastName" placeholder="Enter your Last Name" required>
                                  </div>

                                  <!-- Email Input -->
                                  <div class="col col-12 mb-3">
                                      <label for="InputEmail" class="form-label fw-bold">Email</label>
                                      <input type="email" class="form-control" id="regInputEmail" placeholder="Enter your Email" required>
                                  </div>

                                  <!-- Password Input -->
                                  <div class="col col-12 mb-3">
                                      <label for="InputPassword" class="form-label fw-bold">Password</label>
                                      <input type="password" class="form-control" id="regInputPassword" placeholder="Enter a password" required>
                                  </div>

                                  <!-- Confirm Password Input -->
                                  <div class="col-12 mb-3">
                                      <label for="InputConfirm" class="form-label fw-bold">Confirm Password</label>
                                      <input type="password" class="form-control" id="regInputConfirm" placeholder="Confirm your password" required>
                                  </div>

                                  <!-- Agree to Terms of Service Input -->
                                  <div class="form-row d-flex justify-content-center mt-3">
                                    <div class="col col-12">
                                      <input type="checkbox" class="form-check-input" id="regAgreeToS" required>
                                      <label for="regAgreeToS" class="form-label ms-3">I agree to give personal data to the platform.</label>
                                    </div>
                                  </div>
                              </div>

                              <!-- Register Outcome Message -->
                              <div class="d-flex justify-content-center" id="userRegisterMessage"></div>

                              <!-- Register button -->
                              <div class="d-flex justify-content-center pt-3">
                                  <button id="signUpButton" class="btn btn-primary btn-lg px-3">Sign Up</button>
                              </div>
                          </form>
                      </div>

                      <!-- account tab of the modal -->
                      <div class="tab-pane fade" id="nav-account" role="tabpanel">

                        <div class="accordion" id="utilityAccordion">
                            <!-- Resending the confirmation email utility -->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="resendConfirmation">
                                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseResendConfirmation">
                                    Resend Confirmation Email
                                  </button>
                                </h2>
                                <div id="collapseResendConfirmation" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accountAccordion">
                                  <div class="accordion-body">

                                      <!-- Displays Verification form -->
                                      <form class="pt-1" onsubmit="resendConfirmationEmail(event)">
                                          <div class="row container">
                                              <!-- Email Token -->
                                              <div class="col col-12 mb-3">
                                                  <label for="resendConfirmationEmailField" class="form-label fw-bold">Email</label>
                                                  <input type="email" class="form-control" id="resendConfirmationEmailField" placeholder="Email" required>
                                              </div>
                                          </div>


                                            <!-- Verification Outcome Message -->
                                            <div class="d-flex justify-content-center my-2" id="resendConfirmationMessage"></div>

                                            <!-- Verification button -->
                                            <div class="d-flex justify-content-center pt-3">
                                                <button id="resendConfirmationButton" class="btn btn-primary px-3">Resend Confirmation Email</button>
                                            </div>
                                      </form>
                                  </div>
                                </div>
                              </div>
                            <!-- Verifying user email utility -->
                            <div class="accordion-item">
                              <h2 class="accordion-header" id="emailVerification">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEmailVerification">
                                  Email Verification
                                </button>
                              </h2>
                              <div id="collapseEmailVerification" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accountAccordion">
                                <div class="accordion-body">

                                    <!-- Displays Verification form -->
                                    <form class="pt-1" onsubmit="verifyEmail(event)">
                                        <div class="row container">
                                            <!-- Email Token -->
                                            <div class="col col-12 mb-3">
                                                <label for="emailVerifyActual" class="form-label fw-bold">Email</label>
                                                <input type="email" class="form-control" id="emailVerifyActual" placeholder="Confirm Email" required>
                                            </div>
                                        </div>

                                        <div class="row container">
                                            <!-- Confirmation Token -->
                                            <div class="col col-12 mb-3">
                                                <label for="emailToken" class="form-label fw-bold">Verification Token</label>
                                                <input type="text" class="form-control" id="emailToken" placeholder="Email Verification Token" required>
                                            </div>
                                        </div>

                                        <!-- Verification Outcome Message -->
                                        <div class="d-flex justify-content-center my-2" id="verificationMessage"></div>

                                        <!-- Verification button -->
                                        <div class="d-flex justify-content-center pt-3">
                                            <button id="verificationButton" class="btn btn-primary px-3">Verify Email Address</button>
                                        </div>
                                    </form>
                                
                                
                                
                                </div>
                              </div>
                            </div>

                            <!-- Resetting the user's password utility -->
                            <div class="accordion-item">
                              <h2 class="accordion-header" id="resetPassword">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseResetPassword">
                                  Reset Password
                                </button>
                              </h2>
                              <div id="collapseResetPassword" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accountAccordion">
                                <div class="accordion-body">

                                    <!-- Displays Reset Password form -->
                                    <form class="pt-1" onsubmit="resetPassword(event)">
                                        <div class="row container">
                                            <!-- Email Token -->
                                            <div class="col col-12 mb-3">
                                                <label for="emailResetToken" class="form-label fw-bold">Email</label>
                                                <input type="email" class="form-control" id="emailResetToken" placeholder="Confirm Email" required>
                                            </div>
                                        </div>

                                        <div class="row container">
                                            <!-- Confirmation Token -->
                                            <div class="col col-12 mb-3">
                                                <label for="resetToken" class="form-label fw-bold">Reset Token</label>
                                                <input type="text" class="form-control" id="resetToken" placeholder="Reset Verification Token" required>
                                            </div>
                                        </div>

                                        <div class="row container">
                                            <!-- Password -->
                                            <div class="col col-12 mb-3">
                                                <label for="rPassword" class="form-label fw-bold">Password</label>
                                                <input type="password" class="form-control" id="rPassword" placeholder="Password" required>
                                            </div>
                                        </div>

                                        <div class="row container">
                                            <!-- Confirm Password -->
                                            <div class="col col-12 mb-3">
                                                <label for="rConfirmPassword" class="form-label fw-bold">Confirm Password</label>
                                                <input type="password" class="form-control" id="rConfirmPassword" placeholder="Confirm Password" required>
                                            </div>
                                        </div>

                                        <!-- Verification Outcome Message -->
                                        <div class="d-flex justify-content-center" id="resetPasswordMessage"></div>

                                        <!-- Verification button -->
                                        <div class="d-flex justify-content-center pt-3">
                                            <button id="resetPasswordButton" class="btn btn-primary px-3">Reset Password</button>
                                        </div>
                                    </form>
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="modal-footer"></div>

          </div>
      </div>
    </div>

    <!-- Councillor Information Modal -->
    <div class="modal fade" id="councillorInfoModal" tabindex="-1" aria-labelledby="councillorInfoModalLabel" aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <!-- Displays modal header and close button -->
              <div class="modal-header">
                  <h5 class="modal-title" id="councillorInfoModalLabel">Councillor Information</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              
              <!-- Councillor information is displayed here and is dynamically loaded by AJAXing into this section -->
              <div class="modal-body" id="councillorModalInfo"></div>

              <!-- Close button for modal -->
              <div class="modal-footer" id="councillorModalFooter">
              </div>
          </div>
      </div>
    </div>

    <!-- Dashboard Modal -->
    <div class="dashboardModal modal fade" id="dashboardModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <!-- Dashboard modal shows information on a selected pothole that the user has reported -->
            <div class="modal-header">
                <h5 class="modal-title" id="dashboard-title">Modal title</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div id="dashboard-body" class="modal-body">
                <!-- Dashboard body content loaded here -->
                <div class="text-center">
                    <b class="text-danger text-center">Loading...</b>
                </div>
            </div>
            <div id="dashboard-footer" class="modal-footer">
            </div>
        </div>
      </div>
    </div>


    <noscript class="text-center text-primary"><h3>Please enable javascript to use this application.</h3></noscript>
      <!-- Offcanvas used to display constituency information, reports, and votes for whenever a pothole is clicked on the map -->
      <div class="offcanvas offcanvas-end" data-bs-scroll="true" tabindex="-1" id="offcanvasReport" aria-labelledby="offcanvasWithBothOptionsLabel">
          <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Pothole Report Information</h5>
              <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body p-0">
            <div id="constituencyInformationPanel" class="bg-image">
              <!-- Constituency Information is dynamically loaded into this div via AJAX-->
              <h1 id="constituencyName" class="text-center fw-bold display-6 text-white pt-3"></h1>

              <!-- Councillor information is dynamically loaded into this div via AJAX-->
              <div id="councillorInformation" class="p-3"></div>
            </div>
            <hr class="my-0">
            
            <div id="numberOfReportsArea" class="text-center fw-bold mt-3 mb-3"></div>

            <div>
                <!-- Reports are dynamically loaded into this div as accordion lists via AJAX-->
                <div class="accordion m-0" id="reportAccordion"></div>
            </div>
          </div>
      </div>
  
  </main>
  <!-- End #main -->

  <!-- Bootstrap Core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-storage.js"></script>

  <!-- Main constants file -->
  <script src="js/constants.js"></script>

  <!-- Main web javascript file -->
  <script src="js/index.js"></script>

  <!-- Map javascript -->
  <script src="js/map.js"></script>
</body>

</html>